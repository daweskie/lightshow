   1              		.syntax unified
   2              		.cpu cortex-m4
   3              		.eabi_attribute 27, 3
   4              		.fpu fpv4-sp-d16
   5              		.eabi_attribute 20, 1
   6              		.eabi_attribute 21, 1
   7              		.eabi_attribute 23, 3
   8              		.eabi_attribute 24, 1
   9              		.eabi_attribute 25, 1
  10              		.eabi_attribute 26, 1
  11              		.eabi_attribute 30, 6
  12              		.eabi_attribute 34, 1
  13              		.eabi_attribute 18, 4
  14              		.thumb
  15              		.file	"main.c"
  16              		.text
  17              	.Ltext0:
  18              		.cfi_sections	.debug_frame
  19              		.section	.bss.SDU1,"aw",%nobits
  20              		.align	2
  23              	SDU1:
  24 0000 00000000 		.space	600
  24      00000000 
  24      00000000 
  24      00000000 
  24      00000000 
  25              		.section	.rodata
  26              		.align	2
  27              	.LC0:
  28 0000 6D656D00 		.ascii	"mem\000"
  29              		.align	2
  30              	.LC1:
  31 0004 74687265 		.ascii	"threads\000"
  31      61647300 
  32              		.align	2
  33              	.LC2:
  34 000c 746F6767 		.ascii	"toggle\000"
  34      6C6500
  35 0013 00       		.align	2
  36              	.LC3:
  37 0014 7400     		.ascii	"t\000"
  38 0016 0000     		.align	2
  39              	.LC4:
  40 0018 626C696E 		.ascii	"blinkspeed\000"
  40      6B737065 
  40      656400
  41 0023 00       		.align	2
  42              	.LC5:
  43 0024 627300   		.ascii	"bs\000"
  44 0027 00       		.align	2
  45              	.LC6:
  46 0028 64697200 		.ascii	"dir\000"
  47              		.align	2
  48              	.LC7:
  49 002c 64697263 		.ascii	"dirch\000"
  49      6800
  50 0032 0000     		.align	2
  51              	.LC8:
  52 0034 61637475 		.ascii	"actual\000"
  52      616C00
  53 003b 00       		.align	2
  54              	.LC9:
  55 003c 62736D69 		.ascii	"bsmin\000"
  55      6E00
  56 0042 0000     		.align	2
  57              	.LC10:
  58 0044 62736D61 		.ascii	"bsmax\000"
  58      7800
  59 004a 0000     		.align	2
  60              	.LC11:
  61 004c 62736D69 		.ascii	"bsminch\000"
  61      6E636800 
  62              		.align	2
  63              	.LC12:
  64 0054 62736D61 		.ascii	"bsmaxch\000"
  64      78636800 
  65              		.section	.rodata.commands,"a",%progbits
  66              		.align	2
  69              	commands:
  70 0000 00000000 		.word	.LC0
  71 0004 00000000 		.word	cmd_mem
  72 0008 04000000 		.word	.LC1
  73 000c 00000000 		.word	cmd_threads
  74 0010 0C000000 		.word	.LC2
  75 0014 00000000 		.word	cmd_toggle
  76 0018 14000000 		.word	.LC3
  77 001c 00000000 		.word	cmd_toggle
  78 0020 18000000 		.word	.LC4
  79 0024 00000000 		.word	cmd_blinkspeed
  80 0028 24000000 		.word	.LC5
  81 002c 00000000 		.word	cmd_blinkspeed
  82 0030 28000000 		.word	.LC6
  83 0034 00000000 		.word	cmd_way
  84 0038 2C000000 		.word	.LC7
  85 003c 00000000 		.word	cmd_way_ch
  86 0040 34000000 		.word	.LC8
  87 0044 00000000 		.word	cmd_blinkspeed_now
  88 0048 3C000000 		.word	.LC9
  89 004c 00000000 		.word	cmd_blinkspeed_min
  90 0050 44000000 		.word	.LC10
  91 0054 00000000 		.word	cmd_blinkspeed_max
  92 0058 4C000000 		.word	.LC11
  93 005c 00000000 		.word	cmd_blinkspeed_min_ch
  94 0060 54000000 		.word	.LC12
  95 0064 00000000 		.word	cmd_blinkspeed_max_ch
  96 0068 00000000 		.word	0
  97 006c 00000000 		.word	0
  98              		.section	.rodata.shell_cfg1,"a",%progbits
  99              		.align	2
 102              	shell_cfg1:
 103 0000 00000000 		.word	SDU1
 104 0004 00000000 		.word	commands
 105              		.section	.text.main,"ax",%progbits
 106              		.align	2
 107              		.p2align 4,,15
 108              		.global	main
 109              		.thumb
 110              		.thumb_func
 112              	main:
 113              	.LFB118:
 114              		.file 1 "main.c"
   1:main.c        **** /*
   2:main.c        **** 		ChibiOS/RT - Copyright (C) 2006,2007,2008,2009,2010,
   3:main.c        **** 								 2011,2012 Giovanni Di Sirio.
   4:main.c        **** 
   5:main.c        **** 		This file is part of ChibiOS/RT.
   6:main.c        **** 
   7:main.c        **** 		ChibiOS/RT is free software; you can redistribute it and/or modify
   8:main.c        **** 		it under the terms of the GNU General Public License as published by
   9:main.c        **** 		the Free Software Foundation; either version 3 of the License, or
  10:main.c        **** 		(at your option) any later version.
  11:main.c        **** 
  12:main.c        **** 		ChibiOS/RT is distributed in the hope that it will be useful,
  13:main.c        **** 		but WITHOUT ANY WARRANTY; without even the implied warranty of
  14:main.c        **** 		MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.	See the
  15:main.c        **** 		GNU General Public License for more details.
  16:main.c        **** 
  17:main.c        **** 		You should have received a copy of the GNU General Public License
  18:main.c        **** 		along with this program.	If not, see <http://www.gnu.org/licenses/>.
  19:main.c        ****  */
  20:main.c        **** 
  21:main.c        **** #include <stdio.h>
  22:main.c        **** #include <string.h>
  23:main.c        **** #include <stdlib.h>
  24:main.c        **** 
  25:main.c        **** #include "ch.h"
  26:main.c        **** #include "hal.h"
  27:main.c        **** 
  28:main.c        **** #include "myMisc.h"
  29:main.c        **** #include "buttonpush.h"
  30:main.c        **** #include "chprintf.h"
  31:main.c        **** #include "usbcfg.h"
  32:main.c        **** 
  33:main.c        **** #include "menu.h"
  34:main.c        **** //#include "config.h"
  35:main.c        **** 
  36:main.c        **** 
  37:main.c        **** 
  38:main.c        **** 
  39:main.c        **** 
  40:main.c        **** 
  41:main.c        **** 
  42:main.c        **** 
  43:main.c        **** 
  44:main.c        **** /*
  45:main.c        ****  * Shell configuration
  46:main.c        ****  */
  47:main.c        **** 
  48:main.c        **** #define SHELL_WA_SIZE	 THD_WA_SIZE(2048)
  49:main.c        **** 
  50:main.c        **** 
  51:main.c        **** 
  52:main.c        **** 
  53:main.c        **** 
  54:main.c        **** /*
  55:main.c        ****  * Application entry point.
  56:main.c        ****  */
  57:main.c        **** int main(void)
  58:main.c        **** {
 115              		.loc 1 58 0
 116              		.cfi_startproc
 117              		@ args = 0, pretend = 0, frame = 8
 118              		@ frame_needed = 0, uses_anonymous_args = 0
 119 0000 00B5     		push	{lr}
 120              		.cfi_def_cfa_offset 4
 121              		.cfi_offset 14, -4
 122 0002 83B0     		sub	sp, sp, #12
 123              		.cfi_def_cfa_offset 16
  59:main.c        **** 
  60:main.c        **** //    char msg[]="sos sos sos";
  61:main.c        **** 
  62:main.c        ****     /*
  63:main.c        ****      * Shell thread
  64:main.c        ****      */
  65:main.c        ****     Thread *shelltp = NULL;
 124              		.loc 1 65 0
 125 0004 0023     		movs	r3, #0
 126 0006 0193     		str	r3, [sp, #4]
  66:main.c        **** 
  67:main.c        ****     /*
  68:main.c        ****      * System initializations.
  69:main.c        ****      * - HAL initialization, this also initializes the configured device drivers
  70:main.c        ****      *	 and performs the board-specific initializations.
  71:main.c        ****      * - Kernel initialization, the main() function becomes a thread and the
  72:main.c        ****      *	 RTOS is active.
  73:main.c        ****      */
  74:main.c        ****     halInit();
 127              		.loc 1 74 0
 128 0008 FFF7FEFF 		bl	halInit
  75:main.c        ****     chSysInit();
 129              		.loc 1 75 0
 130 000c FFF7FEFF 		bl	chSysInit
  76:main.c        **** 
  77:main.c        ****     /*
  78:main.c        ****      * Initializes a serial-over-USB CDC driver.
  79:main.c        ****      */
  80:main.c        ****     sduObjectInit(&SDU1);
 131              		.loc 1 80 0
 132 0010 2448     		ldr	r0, .L6
 133 0012 FFF7FEFF 		bl	sduObjectInit
  81:main.c        ****     sduStart(&SDU1, &serusbcfg);
 134              		.loc 1 81 0
 135 0016 2348     		ldr	r0, .L6
 136 0018 2349     		ldr	r1, .L6+4
 137 001a FFF7FEFF 		bl	sduStart
  82:main.c        **** 
  83:main.c        ****     /*
  84:main.c        ****      * Activates the USB driver and then the USB bus pull-up on D+.
  85:main.c        ****      * Note, a delay is inserted in order to not have to disconnect the cable
  86:main.c        ****      * after a reset.
  87:main.c        ****      */
  88:main.c        ****     usbDisconnectBus(serusbcfg.usbp);
 138              		.loc 1 88 0
 139 001e 224B     		ldr	r3, .L6+4
 140 0020 1B68     		ldr	r3, [r3]
 141 0022 DB6B     		ldr	r3, [r3, #60]
 142 0024 204A     		ldr	r2, .L6+4
 143 0026 1268     		ldr	r2, [r2]
 144 0028 D26B     		ldr	r2, [r2, #60]
 145 002a 926B     		ldr	r2, [r2, #56]
 146 002c 22F40022 		bic	r2, r2, #524288
 147 0030 9A63     		str	r2, [r3, #56]
  89:main.c        ****     chThdSleepMilliseconds(2000);
 148              		.loc 1 89 0
 149 0032 44F61760 		movw	r0, #19991
 150 0036 FFF7FEFF 		bl	chThdSleep
  90:main.c        ****     usbStart(serusbcfg.usbp, &usbcfg);
 151              		.loc 1 90 0
 152 003a 1B4B     		ldr	r3, .L6+4
 153 003c 1B68     		ldr	r3, [r3]
 154 003e 1846     		mov	r0, r3
 155 0040 1A49     		ldr	r1, .L6+8
 156 0042 FFF7FEFF 		bl	usbStart
  91:main.c        ****     usbConnectBus(serusbcfg.usbp);
 157              		.loc 1 91 0
 158 0046 184B     		ldr	r3, .L6+4
 159 0048 1B68     		ldr	r3, [r3]
 160 004a DB6B     		ldr	r3, [r3, #60]
 161 004c 164A     		ldr	r2, .L6+4
 162 004e 1268     		ldr	r2, [r2]
 163 0050 D26B     		ldr	r2, [r2, #60]
 164 0052 926B     		ldr	r2, [r2, #56]
 165 0054 42F40022 		orr	r2, r2, #524288
 166 0058 9A63     		str	r2, [r3, #56]
  92:main.c        **** 
  93:main.c        ****     startBlinker();
 167              		.loc 1 93 0
 168 005a FFF7FEFF 		bl	startBlinker
  94:main.c        ****     startButton();
 169              		.loc 1 94 0
 170 005e FFF7FEFF 		bl	startButton
 171              	.L5:
  95:main.c        **** 
  96:main.c        ****     /*
  97:main.c        ****      * Main loop, does nothing except
  98:main.c        ****      */
  99:main.c        **** 
 100:main.c        ****     while (TRUE)
 101:main.c        ****     {
 102:main.c        **** 
 103:main.c        **** 		/* spawn a shell when the old one was terminated */
 104:main.c        ****         if (!shelltp)
 172              		.loc 1 104 0
 173 0062 019B     		ldr	r3, [sp, #4]
 174 0064 002B     		cmp	r3, #0
 175 0066 0ED1     		bne	.L2
 105:main.c        ****         {
 106:main.c        ****             if (SDU1.config->usbp->state == USB_ACTIVE)
 176              		.loc 1 106 0
 177 0068 0E4B     		ldr	r3, .L6
 178 006a D3F85432 		ldr	r3, [r3, #596]
 179 006e 1B68     		ldr	r3, [r3]
 180 0070 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 181 0072 042B     		cmp	r3, #4
 182 0074 11D1     		bne	.L4
 107:main.c        ****             {
 108:main.c        ****                 /* Spawns a new shell.*/
 109:main.c        ****                 shelltp = shellCreate(&shell_cfg1, SHELL_WA_SIZE, NORMALPRIO-10);
 183              		.loc 1 109 0
 184 0076 0E48     		ldr	r0, .L6+12
 185 0078 40F63811 		movw	r1, #2360
 186 007c 3622     		movs	r2, #54
 187 007e FFF7FEFF 		bl	shellCreate
 188 0082 0190     		str	r0, [sp, #4]
 189 0084 09E0     		b	.L4
 190              	.L2:
 110:main.c        ****             }
 111:main.c        ****         }
 112:main.c        ****         else
 113:main.c        ****         {
 114:main.c        ****             /* If the previous shell exited.*/
 115:main.c        ****             if (chThdTerminated(shelltp))
 191              		.loc 1 115 0
 192 0086 019B     		ldr	r3, [sp, #4]
 193 0088 93F82030 		ldrb	r3, [r3, #32]	@ zero_extendqisi2
 194 008c 0E2B     		cmp	r3, #14
 195 008e 04D1     		bne	.L4
 116:main.c        ****             {
 117:main.c        ****                 /* Recovers memory of the previous shell.*/
 118:main.c        ****                 chThdRelease(shelltp);
 196              		.loc 1 118 0
 197 0090 0198     		ldr	r0, [sp, #4]
 198 0092 FFF7FEFF 		bl	chThdRelease
 119:main.c        ****                 shelltp = NULL;
 199              		.loc 1 119 0
 200 0096 0023     		movs	r3, #0
 201 0098 0193     		str	r3, [sp, #4]
 202              	.L4:
 120:main.c        ****             }
 121:main.c        ****         }
 122:main.c        **** 
 123:main.c        ****         chThdSleepMilliseconds(50);
 203              		.loc 1 123 0
 204 009a 40F2EB10 		movw	r0, #491
 205 009e FFF7FEFF 		bl	chThdSleep
 124:main.c        **** 
 125:main.c        ****     }
 206              		.loc 1 125 0
 207 00a2 DEE7     		b	.L5
 208              	.L7:
 209              		.align	2
 210              	.L6:
 211 00a4 00000000 		.word	SDU1
 212 00a8 00000000 		.word	serusbcfg
 213 00ac 00000000 		.word	usbcfg
 214 00b0 00000000 		.word	shell_cfg1
 215              		.cfi_endproc
 216              	.LFE118:
 218 00b4 AFF30080 		.text
 218      AFF30080 
 218      AFF30080 
 219              	.Letext0:
 220              		.file 2 "/usr/include/newlib/machine/_default_types.h"
 221              		.file 3 "/usr/lib/gcc/arm-none-eabi/4.8/include/stddef.h"
 222              		.file 4 "/usr/include/newlib/stdint.h"
 223              		.file 5 "/usr/src/chibiostest/os/ports/GCC/ARMCMx/chtypes.h"
 224              		.file 6 "/usr/src/chibiostest/os/kernel/include/chlists.h"
 225              		.file 7 "/usr/src/chibiostest/os/kernel/include/chthreads.h"
 226              		.file 8 "/usr/src/chibiostest/os/ports/GCC/ARMCMx/chcore_v7m.h"
 227              		.file 9 "/usr/src/chibiostest/os/kernel/include/chmtx.h"
 228              		.file 10 "/usr/src/chibiostest/os/kernel/include/chevents.h"
 229              		.file 11 "/usr/src/chibiostest/os/kernel/include/chqueues.h"
 230              		.file 12 "/usr/src/chibiostest/os/kernel/include/chstreams.h"
 231              		.file 13 "/usr/src/chibiostest/os/hal/include/usb.h"
 232              		.file 14 "/usr/src/chibiostest/os/hal/platforms/STM32/OTGv1/usb_lld.h"
 233              		.file 15 "/usr/src/chibiostest/os/hal/platforms/STM32/OTGv1/stm32_otg.h"
 234              		.file 16 "/usr/src/chibiostest/os/hal/include/serial_usb.h"
 235              		.file 17 "/usr/src/chibiostest/os/various/shell.h"
 236              		.file 18 "menu.h"
 237              		.file 19 "/usr/src/chibiostest/os/ports/common/ARMCMx/CMSIS/include/core_cm4.h"
 238              		.file 20 "usbcfg.h"
DEFINED SYMBOLS
                            *ABS*:0000000000000000 main.c
     /tmp/ccUScrbZ.s:20     .bss.SDU1:0000000000000000 $d
     /tmp/ccUScrbZ.s:23     .bss.SDU1:0000000000000000 SDU1
     /tmp/ccUScrbZ.s:26     .rodata:0000000000000000 $d
     /tmp/ccUScrbZ.s:66     .rodata.commands:0000000000000000 $d
     /tmp/ccUScrbZ.s:69     .rodata.commands:0000000000000000 commands
     /tmp/ccUScrbZ.s:99     .rodata.shell_cfg1:0000000000000000 $d
     /tmp/ccUScrbZ.s:102    .rodata.shell_cfg1:0000000000000000 shell_cfg1
     /tmp/ccUScrbZ.s:106    .text.main:0000000000000000 $t
     /tmp/ccUScrbZ.s:112    .text.main:0000000000000000 main
     /tmp/ccUScrbZ.s:211    .text.main:00000000000000a4 $d
                     .debug_frame:0000000000000010 $d
     /tmp/ccUScrbZ.s:218    .text.main:00000000000000b4 $t

UNDEFINED SYMBOLS
cmd_mem
cmd_threads
cmd_toggle
cmd_blinkspeed
cmd_way
cmd_way_ch
cmd_blinkspeed_now
cmd_blinkspeed_min
cmd_blinkspeed_max
cmd_blinkspeed_min_ch
cmd_blinkspeed_max_ch
halInit
chSysInit
sduObjectInit
sduStart
chThdSleep
usbStart
startBlinker
startButton
shellCreate
chThdRelease
serusbcfg
usbcfg
